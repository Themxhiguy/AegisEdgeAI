INFO:__main__:[2m2025-08-26T17:41:09.121675Z[0m [[32m[1minfo     [0m] [1mCollector logging configuration[0m [[34m[1m__main__[0m] [36mdebug_all[0m=[35mFalse[0m [36mdebug_collector[0m=[35mFalse[0m [36mlog_level[0m=[35mINFO[0m
INFO:utils.public_key_utils:[2m2025-08-26T17:41:09.124776Z[0m [[32m[1minfo     [0m] [1mPublicKeyUtils initialization [0m [[34m[1mutils.public_key_utils[0m] [36mpublic_key_path[0m=[35m/mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/appsk_pubkey.pem[0m [36mverify_script_path[0m=[35m/mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/verify_app_message_signature.sh[0m
INFO:utils.public_key_utils:[2m2025-08-26T17:41:09.125229Z[0m [[32m[1minfo     [0m] [1mPublicKeyUtils initialized    [0m [[34m[1mutils.public_key_utils[0m] [36mpublic_key_path[0m=[35mtpm/appsk_pubkey.pem[0m [36mverify_script_path[0m=[35mtpm/verify_app_message_signature.sh[0m
INFO:__main__:[2m2025-08-26T17:41:09.125531Z[0m [[32m[1minfo     [0m] [1mPublic key utilities initialized successfully[0m [[34m[1m__main__[0m] 
DEBUG:utils.agent_verification_utils:[2m2025-08-26T17:41:09.125812Z[0m [[32m[1mdebug    [0m] [1mLoading allowed agents        [0m [[34m[1mutils.agent_verification_utils[0m] [36mfile_path[0m=[35m/mnt/c/Users/ramkr/CitadelAI/zero-trust/collector/allowed_agents.json[0m
DEBUG:utils.agent_verification_utils:[2m2025-08-26T17:41:09.129962Z[0m [[32m[1mdebug    [0m] [1mFile content loaded           [0m [[34m[1mutils.agent_verification_utils[0m] [36mcontent_length[0m=[35m1285[0m
DEBUG:utils.agent_verification_utils:[2m2025-08-26T17:41:09.130785Z[0m [[32m[1mdebug    [0m] [1mJSON parsed successfully      [0m [[34m[1mutils.agent_verification_utils[0m] [36magents_length[0m=[35m2[0m [36magents_type[0m=[35m<class 'list'>[0m
INFO:utils.agent_verification_utils:[2m2025-08-26T17:41:09.131102Z[0m [[32m[1minfo     [0m] [1mAllowed agents loaded successfully[0m [[34m[1mutils.agent_verification_utils[0m] [36magent_count[0m=[35m2[0m [36magent_names[0m=[35m['agent-001', 'agent-geo-policy-violation-002'][0m
INFO:utils.agent_verification_utils:[2m2025-08-26T17:41:09.131366Z[0m [[32m[1minfo     [0m] [1mAgentVerificationUtils initialized[0m [[34m[1mutils.agent_verification_utils[0m] [36magent_count[0m=[35m2[0m [36mallowed_agents_path[0m=[35m/mnt/c/Users/ramkr/CitadelAI/zero-trust/collector/allowed_agents.json[0m
INFO:__main__:[2m2025-08-26T17:41:09.131544Z[0m [[32m[1minfo     [0m] [1mAgent verification utilities initialized successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-26T17:41:09.138390Z[0m [[32m[1minfo     [0m] [1mSkipping OpenTelemetry metrics setup for compatibility[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-26T17:41:09.138824Z[0m [[32m[1minfo     [0m] [1mOpenTelemetry setup completed (OTLP export disabled)[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-26T17:41:09.186163Z[0m [[32m[1minfo     [0m] [1mGenerated temporary SSL certificates[0m [[34m[1m__main__[0m] [36mcert_path[0m=[35m/tmp/tmpq2cfiez7.pem[0m [36mkey_path[0m=[35m/tmp/tmpiztxja4m.pem[0m
 * Serving Flask app 'app'
 * Debug mode: off
INFO:__main__:[2m2025-08-26T17:41:11.141889Z[0m [[32m[1minfo     [0m] [1müîÑ [COLLECTOR] Starting nonce generation[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mrequest_ip[0m=[35m127.0.0.1[0m
INFO:__main__:[2m2025-08-26T17:41:11.142479Z[0m [[32m[1minfo     [0m] [1müé≤ [NONCE_MANAGER] Fresh nonce created for agent[0m [[34m[1m__main__[0m] [36magent_nonce_count[0m=[35m1[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m [36mtotal_active_nonces[0m=[35m1[0m [36mtotal_agents_with_nonces[0m=[35m1[0m
INFO:__main__:[2m2025-08-26T17:41:11.143029Z[0m [[32m[1minfo     [0m] [1m‚úÖ [COLLECTOR] Nonce generated successfully[0m [[34m[1m__main__[0m] [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m [36mtotal_active_nonces[0m=[35m1[0m
INFO:__main__:[2m2025-08-26T17:41:11.323581Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Validating nonce for agent[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m
DEBUG:__main__:[2m2025-08-26T17:41:11.324058Z[0m [[32m[1mdebug    [0m] [1müîç [NONCE_MANAGER] Comparing public keys for nonce validation[0m [[34m[1m__main__[0m] [36mactual_agent_key_length[0m=[35m392[0m [36mactual_agent_key_start[0m=[35mMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1Hsd5...[0m [36mexpected_agent_key_length[0m=[35m392[0m [36mexpected_agent_key_start[0m=[35mMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1Hsd5...[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m
INFO:__main__:[2m2025-08-26T17:41:11.324325Z[0m [[32m[1minfo     [0m] [1m‚úÖ [COLLECTOR] Nonce validation successful for agent[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m
INFO:__main__:[2m2025-08-26T17:41:11.324552Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Starting signature verification with key[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36mnonce[0m=[35m8ccb358b8c7fe706...[0m [36mpublic_key_length[0m=[35m444[0m [36msignature[0m=[35ma1092e06f13a38e896ce5b34590a79fb...[0m
INFO:__main__:[2m2025-08-26T17:41:11.324816Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Reconstructed data for verification with key[0m [[34m[1m__main__[0m] [36mdata_json[0m=[35m{"geographic_region": {"city": "Santa Clara", "region": "US", "state": "California"}, "metrics": {"metrics": {"active_connections": 46, "error_rate": 3.6087370196891273, "requests_per_second": 46.18051286364073, "response_time_ms": 416.35696886948466}, "service": {"instance_id": "unknown", "name": "opentelemetry-agent", "version": "1.0.0"}, "timestamp": "2025-08-26T17:41:11.109228"}}[0m [36mdata_length[0m=[35m386[0m [36mnonce[0m=[35m8ccb358b8c7fe7068bb8c6d2d2e684e0[0m
INFO:__main__:[2m2025-08-26T17:41:11.354857Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] TPM2 signature verification successful[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-26T17:41:11.355411Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Signature verification result with key[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36mis_valid[0m=[35mTrue[0m
INFO:utils.agent_verification_utils:[2m2025-08-26T17:41:11.355735Z[0m [[32m[1minfo     [0m] [1mTPM public key hash verification successful[0m [[34m[1mutils.agent_verification_utils[0m] [36magent_name[0m=[35magent-001[0m
INFO:utils.agent_verification_utils:[2m2025-08-26T17:41:11.355960Z[0m [[32m[1minfo     [0m] [1mAgent verification successful [0m [[34m[1mutils.agent_verification_utils[0m] [36magent_name[0m=[35magent-001[0m [36mgeolocation[0m=[35m{'country': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m
INFO:__main__:[2m2025-08-26T17:41:11.356248Z[0m [[32m[1minfo     [0m] [1mGeographic region verification successful[0m [[34m[1m__main__[0m] [36mcity[0m=[35mSanta Clara[0m [36mregion[0m=[35mUS[0m [36mstate[0m=[35mCalifornia[0m
INFO:__main__:[2m2025-08-26T17:41:11.356565Z[0m [[32m[1minfo     [0m] [1müçΩÔ∏è [NONCE_MANAGER] Consuming nonce for agent[0m [[34m[1m__main__[0m] [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_value[0m=[35m8ccb358b8c7fe706...[0m [36mremaining_active_nonces[0m=[35m0[0m [36mremaining_agent_nonces[0m=[35m0[0m
INFO:__main__:[2m2025-08-26T17:41:11.356855Z[0m [[32m[1minfo     [0m] [1mMetrics processed successfully[0m [[34m[1m__main__[0m] [36mservice[0m=[35mopentelemetry-agent[0m
INFO:__main__:[2m2025-08-26T17:41:11.357136Z[0m [[32m[1minfo     [0m] [1mMetrics received and verified successfully[0m [[34m[1m__main__[0m] [36mservice[0m=[35mopentelemetry-agent[0m
INFO:__main__:[2m2025-08-26T17:41:11.434773Z[0m [[32m[1minfo     [0m] [1müîÑ [COLLECTOR] Starting nonce generation[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mrequest_ip[0m=[35m127.0.0.1[0m
INFO:__main__:[2m2025-08-26T17:41:11.435153Z[0m [[32m[1minfo     [0m] [1müé≤ [NONCE_MANAGER] Fresh nonce created for agent[0m [[34m[1m__main__[0m] [36magent_nonce_count[0m=[35m1[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m9edbdf010a4ba906...[0m [36mtotal_active_nonces[0m=[35m1[0m [36mtotal_agents_with_nonces[0m=[35m2[0m
INFO:__main__:[2m2025-08-26T17:41:11.435468Z[0m [[32m[1minfo     [0m] [1m‚úÖ [COLLECTOR] Nonce generated successfully[0m [[34m[1m__main__[0m] [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m9edbdf010a4ba906...[0m [36mtotal_active_nonces[0m=[35m1[0m
INFO:__main__:[2m2025-08-26T17:41:11.592691Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Validating nonce for agent[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_value[0m=[35m9edbdf010a4ba906...[0m
DEBUG:__main__:[2m2025-08-26T17:41:11.593116Z[0m [[32m[1mdebug    [0m] [1müîç [NONCE_MANAGER] Comparing public keys for nonce validation[0m [[34m[1m__main__[0m] [36mactual_agent_key_length[0m=[35m392[0m [36mactual_agent_key_start[0m=[35mMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAplNkgH...[0m [36mexpected_agent_key_length[0m=[35m392[0m [36mexpected_agent_key_start[0m=[35mMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAplNkgH...[0m [36mnonce_value[0m=[35m9edbdf010a4ba906...[0m
INFO:__main__:[2m2025-08-26T17:41:11.593366Z[0m [[32m[1minfo     [0m] [1m‚úÖ [COLLECTOR] Nonce validation successful for agent[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36magent_public_key_fingerprint[0m=[35mMIIBIjANBgkqhkiG...[0m [36mnonce_value[0m=[35m9edbdf010a4ba906...[0m
INFO:__main__:[2m2025-08-26T17:41:11.593577Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Starting signature verification with key[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mnonce[0m=[35m9edbdf010a4ba906...[0m [36mpublic_key_length[0m=[35m444[0m [36msignature[0m=[35m95c7a54a8234ef73af09aa8c656766fb...[0m
INFO:__main__:[2m2025-08-26T17:41:11.593803Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Reconstructed data for verification with key[0m [[34m[1m__main__[0m] [36mdata_json[0m=[35m{"geographic_region": {"city": "Berlin", "region": "EU", "state": "Germany"}, "metrics": {"metrics": {"active_connections": 29, "error_rate": 2.680029425598254, "requests_per_second": 51.761835123354686, "response_time_ms": 322.5599150677063}, "service": {"instance_id": "unknown", "name": "opentelemetry-agent", "version": "1.0.0"}, "timestamp": "2025-08-26T17:41:11.413345"}}[0m [36mdata_length[0m=[35m377[0m [36mnonce[0m=[35m9edbdf010a4ba9069b7b5e31c67c67b2[0m
INFO:__main__:[2m2025-08-26T17:41:11.620339Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] TPM2 signature verification successful[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-26T17:41:11.620710Z[0m [[32m[1minfo     [0m] [1müîç [COLLECTOR] Signature verification result with key[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mis_valid[0m=[35mTrue[0m
WARNING:__main__:[2m2025-08-26T17:41:11.620944Z[0m [[33m[1mwarning  [0m] [1mGeolocation mismatch          [0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mexpected_geo[0m=[35m{'country': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m [36mreceived_geo[0m=[35m{'country': 'EU', 'state': 'Germany', 'city': 'Berlin'}[0m
WARNING:__main__:[2m2025-08-26T17:41:11.685444Z[0m [[33m[1mwarning  [0m] [1m‚ùå [COLLECTOR] Nonce request from unauthorized agent[0m [[34m[1m__main__[0m] [36magent_public_key_hash[0m=[35m1f89bd7ce951bd0e...[0m [36mrequest_ip[0m=[35m127.0.0.1[0m
