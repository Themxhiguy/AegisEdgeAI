INFO:agent.app:[2m2025-09-02T04:20:12.537011Z[0m [[32m[1minfo     [0m] [1mAgent logging configuration   [0m [[34m[1magent.app[0m] [36mdebug_agent[0m=[35mFalse[0m [36mdebug_all[0m=[35mFalse[0m [36mlog_level[0m=[35mINFO[0m
INFO:agent.app:[2m2025-09-02T04:20:12.550545Z[0m [[32m[1minfo     [0m] [1mUsing agent-specific TPM context file[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mcontext_path[0m=[35mtpm/agent-001.ctx[0m
INFO:utils.tpm2_utils:[2m2025-09-02T04:20:12.555190Z[0m [[32m[1minfo     [0m] [1mSoftware TPM (swtpm) is accessible[0m [[34m[1mutils.tpm2_utils[0m] 
INFO:agent.app:[2m2025-09-02T04:20:12.568507Z[0m [[32m[1minfo     [0m] [1mTPM2 utilities initialized successfully[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mcontext_path[0m=[35mtpm/agent-001.ctx[0m [36muse_swtpm[0m=[35mTrue[0m
INFO:agent.app:[2m2025-09-02T04:20:12.576223Z[0m [[32m[1minfo     [0m] [1mSkipping OpenTelemetry metrics setup for compatibility[0m [[34m[1magent.app[0m] 
INFO:agent.app:[2m2025-09-02T04:20:12.577392Z[0m [[32m[1minfo     [0m] [1mOpenTelemetry setup completed (OTLP export disabled)[0m [[34m[1magent.app[0m] 
🚀 Starting agent: agent-001
📁 Config file: agents/agent-001/config.json
🌐 Agent port: 8401
🔐 APP_HANDLE: 0x8101000B
🔗 Gateway: localhost:9000
📊 Collector: localhost:8500
 * Serving Flask app 'agent.app'
 * Debug mode: off
INFO:agent.app:[2m2025-09-02T04:20:13.097924Z[0m [[32m[1minfo     [0m] [1m🔄 [AGENT] Initiating nonce retrieval for metrics[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mmetric_type[0m=[35mapplication[0m
INFO:agent.app:[2m2025-09-02T04:20:13.098514Z[0m [[32m[1minfo     [0m] [1m🔄 [AGENT] Starting nonce request[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mconfig_path[0m=[35magents/agent-001/config.json[0m [36mgateway_url[0m=[35mhttps://localhost:9000[0m
INFO:agent.app:[2m2025-09-02T04:20:13.105013Z[0m [[32m[1minfo     [0m] [1m📤 [AGENT] Sending nonce request to gateway[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mpublic_key_hash[0m=[35mbc4a5eaf76012122...[0m
INFO:agent.app:[2m2025-09-02T04:20:13.105415Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Signature-Input header created[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36msignature_input[0m=[35mkeyid="bc4a5eaf76012122fc442d85c7317e1a7023e4cf30864235117935bab46423d9", created=1756786813, expires=1756787113, alg="RSA"[0m
INFO:agent.app:[2m2025-09-02T04:20:13.105735Z[0m [[32m[1minfo     [0m] [1m📤 [AGENT] Final headers for nonce request (public key hash only)[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mheaders[0m=[35m{'Signature-Input': 'keyid="bc4a5eaf76012122fc442d85c7317e1a7023e4cf30864235117935bab46423d9", created=1756786813, expires=1756787113, alg="RSA"'}[0m
INFO:agent.app:[2m2025-09-02T04:20:13.151441Z[0m [[32m[1minfo     [0m] [1m✅ [AGENT] Nonce received successfully[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m52c9755947ae514f...[0m [36mpublic_key_hash[0m=[35mbc4a5eaf76012122...[0m [36mresponse_status[0m=[35m200[0m
INFO:agent.app:[2m2025-09-02T04:20:13.152121Z[0m [[32m[1minfo     [0m] [1m✅ [AGENT] Nonce retrieved for metrics processing[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mnonce_length[0m=[35m32[0m [36mnonce_value[0m=[35m52c9755947ae514f...[0m
INFO:agent.app:[2m2025-09-02T04:20:13.152463Z[0m [[32m[1minfo     [0m] [1mGeographic region configuration[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36magent_prefix[0m=[35mAGENT_001_[0m [36mcity[0m=[35mSanta Clara[0m [36mregion[0m=[35mUS[0m [36msource[0m=[35mdefault[0m [36mstate[0m=[35mCalifornia[0m
INFO:agent.app:[2m2025-09-02T04:20:13.152777Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Data prepared for signing[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mdata_json[0m=[35m{"geographic_region": {"city": "Santa Clara", "region": "US", "state": "California"}, "metrics": {"metrics": {"active_connections": 70, "error_rate": 0.7242899922086071, "requests_per_second": 51.185817675679154, "response_time_ms": 121.36646395398994}, "service": {"instance_id": "unknown", "name": "opentelemetry-agent", "version": "1.0.0"}, "timestamp": "2025-09-02T04:20:13.097876"}}[0m [36mdata_length[0m=[35m387[0m [36mnonce[0m=[35m52c9755947ae514f0b2436cfd9f1e743[0m
INFO:agent.app:[2m2025-09-02T04:20:13.276119Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Data signed successfully[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36malgorithm[0m=[35msha256[0m [36mdigest[0m=[35m43913b33ffc51ae6422842a3a7fe77eb...[0m [36msignature[0m=[35m96ce68a49e01841e1214273dcfb22764...[0m
INFO:agent.app:[2m2025-09-02T04:20:13.278842Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Payload created for sending[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mmetrics_timestamp[0m=[35m2025-09-02T04:20:13.097876[0m [36mpayload_fields[0m=[35m['agent_name', 'tpm_public_key_hash', 'geolocation', 'metrics', 'geographic_region', 'nonce', 'signature', 'digest', 'algorithm', 'timestamp'][0m [36mpayload_timestamp[0m=[35m2025-09-02T04:20:13.278804[0m
INFO:agent.app:[2m2025-09-02T04:20:13.279104Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Signing Workload-Geo-ID header[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mdata_hash[0m=[35m1644c707c28e275d...[0m [36mworkload_geo_id_length[0m=[35m235[0m
INFO:agent.app:[2m2025-09-02T04:20:13.361880Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Headers prepared for metrics request[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_length[0m=[35m512[0m [36msignature_present[0m=[35mTrue[0m [36mworkload_geo_id_present[0m=[35mTrue[0m
INFO:agent.app:[2m2025-09-02T04:20:13.362698Z[0m [[32m[1minfo     [0m] [1m📤 [AGENT] Sending signed metrics to collector[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mpayload_size[0m=[35m1303[0m [36msignature_length[0m=[35m512[0m
INFO:agent.app:[2m2025-09-02T04:20:13.363153Z[0m [[32m[1minfo     [0m] [1m🔍 [AGENT] Sending metrics with headers[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mhas_signature[0m=[35mTrue[0m [36mhas_signature_input[0m=[35mTrue[0m [36mhas_workload_geo_id[0m=[35mTrue[0m
INFO:agent.app:[2m2025-09-02T04:20:13.468713Z[0m [[32m[1minfo     [0m] [1m✅ [AGENT] Metrics sent successfully to collector[0m [[34m[1magent.app[0m] [36mresponse_size[0m=[35m121[0m [36mresponse_status[0m=[35m200[0m
INFO:agent.app:[2m2025-09-02T04:20:13.469299Z[0m [[32m[1minfo     [0m] [1m🎉 [AGENT] Metrics generation and sending completed successfully[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-001[0m [36mpayload_id[0m=[35m43913b33ffc51ae6[0m [36mtotal_processing_time[0m=[35mcompleted[0m
