INFO:__main__:[2m2025-08-27T21:34:40.420779Z[0m [[32m[1minfo     [0m] [1mGateway logging configuration [0m [[34m[1m__main__[0m] [36mdebug_all[0m=[35mFalse[0m [36mdebug_gateway[0m=[35mFalse[0m [36mlog_level[0m=[35mINFO[0m
INFO:__main__:[2m2025-08-27T21:34:40.432941Z[0m [[32m[1minfo     [0m] [1mSkipping OpenTelemetry metrics setup for compatibility[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:40.433902Z[0m [[32m[1minfo     [0m] [1mOpenTelemetry setup completed (OTLP export disabled)[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:40.439418Z[0m [[32m[1minfo     [0m] [1mGateway allowlist loaded      [0m [[34m[1m__main__[0m] [36magent_count[0m=[35m2[0m [36mpath[0m=[35mgateway/allowed_agents.json[0m
INFO:__main__:[2m2025-08-27T21:34:40.439907Z[0m [[32m[1minfo     [0m] [1mGateway allowlist manager initialized[0m [[34m[1m__main__[0m] [36magent_count[0m=[35m2[0m [36mallowlist_path[0m=[35mgateway/allowed_agents.json[0m [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:40.520359Z[0m [[32m[1minfo     [0m] [1mGenerated temporary SSL certificates[0m [[34m[1m__main__[0m] [36mcert_path[0m=[35m/tmp/tmptssauhvb.pem[0m [36mkey_path[0m=[35m/tmp/tmpk8fa_7zg.pem[0m
 * Serving Flask app 'app'
 * Debug mode: off
INFO:__main__:[2m2025-08-27T21:34:42.360234Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] Full relevant headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mContent-Type[0m=[35mNone[0m [36mSignature[0m=[35mNone[0m [36mSignature-Input[0m=[35mkeyid="716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36mWorkload-Geo-ID[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mmethod[0m=[35mGET[0m
INFO:__main__:[2m2025-08-27T21:34:42.360687Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] API call headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mclient_ip[0m=[35mNone[0m [36mcontent_type[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mexpected_headers_for_endpoint[0m=[35mSignature-Input only (no geolocation)[0m [36mmethod[0m=[35mGET[0m [36mpath[0m=[35m/nonce[0m [36mquery_params[0m=[35m{'public_key_hash': '716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf'}[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_input_value[0m=[35mkeyid="716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36msignature_present[0m=[35mFalse[0m [36msignature_value[0m=[35mNone[0m [36muser_agent[0m=[35mpython-requests/2.31.0[0m [36mworkload_geo_id_present[0m=[35mFalse[0m [36mworkload_geo_id_value[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T21:34:42.363032Z[0m [[32m[1minfo     [0m] [1müìã [GATEWAY] Policy enforcement header summary[0m [[34m[1m__main__[0m] [36mendpoint[0m=[35m/nonce[0m [36mgeolocation_header_present[0m=[35mFalse[0m [36mpolicy_enforcement_ready[0m=[35mTrue[0m [36msignature_header_present[0m=[35mFalse[0m [36msignature_input_present[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.363327Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.363515Z[0m [[32m[1minfo     [0m] [1m‚úÖ [GATEWAY] Nonce validation passed - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.391163Z[0m [[32m[1minfo     [0m] [1mNonce request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.530097Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] Full relevant headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mContent-Type[0m=[35mapplication/json[0m [36mSignature[0m=[35m6e2e9bceda6d96ad8cb9cbb82bd1a6f3ab8880cd9b98230c662adecacda8638f6c15596651fa1ff1d3e3a08d508de79e20582691526e1938778eeb7630febb608511fb1417f5a574a90cda53e491b51e2e0836c49ef925204f720700e57599ae3c7ecc041528a0f834a90883c94b8e3ee220ad6d5172a01c449a3d6e010712dc9c6debebc4aa1db85de836db406dbc085dfca313daa371bb18257e4beaf83cdf5f84e2e413c199e6bdf0ba61f74653c6bc1b64186a9b018ac76411e217942c0e66411a8f9b13c25fd48d4eb56373d992e3fef45627ba5e8ee3bbdb72799ffe72616e20beed057f4e14816c055dcf0b5944c32b34871ceecf9355b5e4b6c2925f[0m [36mSignature-Input[0m=[35mkeyid="716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36mWorkload-Geo-ID[0m=[35m{"client_workload_id":"agent-001","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m [36mendpoint[0m=[35m/metrics[0m [36mmethod[0m=[35mPOST[0m
INFO:__main__:[2m2025-08-27T21:34:42.530498Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] API call headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mclient_ip[0m=[35mNone[0m [36mcontent_type[0m=[35mapplication/json[0m [36mendpoint[0m=[35m/metrics[0m [36mexpected_headers_for_endpoint[0m=[35mWorkload-Geo-ID + Signature-Input + Signature[0m [36mmethod[0m=[35mPOST[0m [36mpath[0m=[35m/metrics[0m [36mquery_params[0m=[35m{}[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_input_value[0m=[35mkeyid="716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36msignature_present[0m=[35mTrue[0m [36msignature_value[0m=[35m6e2e9bceda6d96ad8cb9cbb82bd1a6f3ab8880cd9b98230c662adecacda8638f...[0m [36muser_agent[0m=[35mpython-requests/2.31.0[0m [36mworkload_geo_id_present[0m=[35mTrue[0m [36mworkload_geo_id_value[0m=[35m{"client_workload_id":"agent-001","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T21:34:42.532186Z[0m [[32m[1minfo     [0m] [1müìã [GATEWAY] Policy enforcement header summary[0m [[34m[1m__main__[0m] [36mendpoint[0m=[35m/metrics[0m [36mgeolocation_header_present[0m=[35mTrue[0m [36mpolicy_enforcement_ready[0m=[35mTrue[0m [36msignature_header_present[0m=[35mTrue[0m [36msignature_input_present[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.532495Z[0m [[32m[1minfo     [0m] [1mSecurityManager checking validation conditions for non-nonce request[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.532741Z[0m [[32m[1minfo     [0m] [1mSecurityManager calling validate_request_headers[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.532971Z[0m [[32m[1minfo     [0m] [1mGateway validate_request_headers called[0m [[34m[1m__main__[0m] [36mheaders_present[0m=[35m['Host', 'User-Agent', 'Accept-Encoding', 'Accept', 'Connection', 'Content-Type', 'Workload-Geo-Id', 'Signature-Input', 'Signature', 'Content-Length', 'Traceparent'][0m [36mvalidate_geolocation[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.533150Z[0m [[32m[1minfo     [0m] [1mSignature validation passed (basic format check)[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36mpublic_key_hash[0m=[35m716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf[0m
INFO:__main__:[2m2025-08-27T21:34:42.533311Z[0m [[32m[1minfo     [0m] [1mGateway checking geolocation validation[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mworkload_geo_id_str[0m=[35m{"client_workload_id":"agent-001","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T21:34:42.533541Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation called[0m [[34m[1m__main__[0m] [36mpublic_key_hash[0m=[35m716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf[0m [36mworkload_geo_id[0m=[35m{'client_workload_id': 'agent-001', 'client_workload_location': {'region': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'client_workload_location_type': 'geographic-region', 'client_workload_location_quality': 'GNSS', 'client_type': 'thick'}[0m
INFO:__main__:[2m2025-08-27T21:34:42.533733Z[0m [[32m[1minfo     [0m] [1mGateway geolocation comparison[0m [[34m[1m__main__[0m] [36mactual_city[0m=[35mSANTA CLARA[0m [36mactual_country[0m=[35mUS[0m [36mactual_state[0m=[35mCALIFORNIA[0m [36magent_name[0m=[35magent-001[0m [36mexpected_city[0m=[35mSANTA CLARA[0m [36mexpected_country[0m=[35mUS[0m [36mexpected_state[0m=[35mCALIFORNIA[0m
INFO:__main__:[2m2025-08-27T21:34:42.533886Z[0m [[32m[1minfo     [0m] [1mGeolocation validation passed [0m [[34m[1m__main__[0m] [36mactual_geo[0m=[35m{'region': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m [36magent_name[0m=[35magent-001[0m [36mexpected_geo[0m=[35m{'country': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m
INFO:__main__:[2m2025-08-27T21:34:42.534040Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': True, 'agent': {'agent_name': 'agent-001', 'tpm_public_key': 'MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApDLKWCOxYfBTHu4eN2YwOOMTvy0Uwa612tBx9PkG847clM/bPfS2PyjgmTbfZQ+kuV81x6pIdZqUP43L3sdB1aQMDqfLkcp0TYmE7U9VzcijQvexAAS+yrXHzBJdANraQ3ro5bNq7PtTx/0nUhcwtD6xg9CwRLBEBf31W0qhyk2Uc2FIaHptuvb/o2nu1D31LuCB0qZB+yyqs9ipfiqYNjyN3LP6NBPnKb7dBjLbqeBWA7hgfld5vSrc7l4ROhwIMlZBPgJ5vK7WKHZwVRyduUGukvRbYZGTrgz9oLq5cHi8Alb894dgALLMZYlxZl2j/OBr4vJ4nuzkSw7T8gXHiwIDAQAB', 'tpm_public_key_hash': '716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf', 'geolocation': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'status': 'active', 'created_at': '2025-08-15T18:00:00Z'}, 'reason': 'Geolocation validation passed'}[0m
INFO:__main__:[2m2025-08-27T21:34:42.534222Z[0m [[32m[1minfo     [0m] [1mSecurityManager validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': True, 'agent': {'agent_name': 'agent-001', 'tpm_public_key': 'MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApDLKWCOxYfBTHu4eN2YwOOMTvy0Uwa612tBx9PkG847clM/bPfS2PyjgmTbfZQ+kuV81x6pIdZqUP43L3sdB1aQMDqfLkcp0TYmE7U9VzcijQvexAAS+yrXHzBJdANraQ3ro5bNq7PtTx/0nUhcwtD6xg9CwRLBEBf31W0qhyk2Uc2FIaHptuvb/o2nu1D31LuCB0qZB+yyqs9ipfiqYNjyN3LP6NBPnKb7dBjLbqeBWA7hgfld5vSrc7l4ROhwIMlZBPgJ5vK7WKHZwVRyduUGukvRbYZGTrgz9oLq5cHi8Alb894dgALLMZYlxZl2j/OBr4vJ4nuzkSw7T8gXHiwIDAQAB', 'tpm_public_key_hash': '716d79b029c9c7bf4813fc487eb8e02529475878d8b2024eb2dc6f3424e58baf', 'geolocation': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'status': 'active', 'created_at': '2025-08-15T18:00:00Z'}, 'reason': 'All validations passed'}[0m
INFO:__main__:[2m2025-08-27T21:34:42.600183Z[0m [[32m[1minfo     [0m] [1mMetrics request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.645378Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] Full relevant headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mContent-Type[0m=[35mNone[0m [36mSignature[0m=[35mNone[0m [36mSignature-Input[0m=[35mkeyid="8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36mWorkload-Geo-ID[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mmethod[0m=[35mGET[0m
INFO:__main__:[2m2025-08-27T21:34:42.645779Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] API call headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mclient_ip[0m=[35mNone[0m [36mcontent_type[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mexpected_headers_for_endpoint[0m=[35mSignature-Input only (no geolocation)[0m [36mmethod[0m=[35mGET[0m [36mpath[0m=[35m/nonce[0m [36mquery_params[0m=[35m{'public_key_hash': '8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282'}[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_input_value[0m=[35mkeyid="8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36msignature_present[0m=[35mFalse[0m [36msignature_value[0m=[35mNone[0m [36muser_agent[0m=[35mpython-requests/2.31.0[0m [36mworkload_geo_id_present[0m=[35mFalse[0m [36mworkload_geo_id_value[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T21:34:42.647511Z[0m [[32m[1minfo     [0m] [1müìã [GATEWAY] Policy enforcement header summary[0m [[34m[1m__main__[0m] [36mendpoint[0m=[35m/nonce[0m [36mgeolocation_header_present[0m=[35mFalse[0m [36mpolicy_enforcement_ready[0m=[35mTrue[0m [36msignature_header_present[0m=[35mFalse[0m [36msignature_input_present[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.647823Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.648063Z[0m [[32m[1minfo     [0m] [1m‚úÖ [GATEWAY] Nonce validation passed - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.673315Z[0m [[32m[1minfo     [0m] [1mNonce request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.792582Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] Full relevant headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mContent-Type[0m=[35mapplication/json[0m [36mSignature[0m=[35m1fdedc0ccc596405ca594b86ee6e3a02fe52914ba0e668df4015a1d4f0dec2e5bdd865e39d2ea3e1141daecb58315cd8323c9f2c1b6ccba385ea5cd7ef2c0e98cb284e722501d589ff9b60f949edaaadbdf871ce8e2c91353aa037b585b646e5260359f4627794a12cd25253a6bdb1dc7585ce027b6c6dd05b84abaf7354cedbb699f371e6f57d4da66c6f8f0b07652b620d990689e42a9862b997b9af5a1351cdc0322f7f61078a3429af37eb5e15e1614246dd6da86be56e927a6642ee20cd1021bc47e6b0e8a47a971a91d774a5901ff7c679243cdef3d4662694acc89972ff6fa7d63affaf44e1c70499b1406845e0ccb55e018d2e52788fb4137d34b1cc[0m [36mSignature-Input[0m=[35mkeyid="8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36mWorkload-Geo-ID[0m=[35m{"client_workload_id":"agent-geo-policy-violation-002","client_workload_location":{"region":"EU","state":"Germany","city":"Berlin"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m [36mendpoint[0m=[35m/metrics[0m [36mmethod[0m=[35mPOST[0m
INFO:__main__:[2m2025-08-27T21:34:42.792968Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] API call headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mclient_ip[0m=[35mNone[0m [36mcontent_type[0m=[35mapplication/json[0m [36mendpoint[0m=[35m/metrics[0m [36mexpected_headers_for_endpoint[0m=[35mWorkload-Geo-ID + Signature-Input + Signature[0m [36mmethod[0m=[35mPOST[0m [36mpath[0m=[35m/metrics[0m [36mquery_params[0m=[35m{}[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_input_value[0m=[35mkeyid="8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36msignature_present[0m=[35mTrue[0m [36msignature_value[0m=[35m1fdedc0ccc596405ca594b86ee6e3a02fe52914ba0e668df4015a1d4f0dec2e5...[0m [36muser_agent[0m=[35mpython-requests/2.31.0[0m [36mworkload_geo_id_present[0m=[35mTrue[0m [36mworkload_geo_id_value[0m=[35m{"client_workload_id":"agent-geo-policy-violation-002","client_workload_location":{"region":"EU","state":"Germany","city":"Berlin"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T21:34:42.794679Z[0m [[32m[1minfo     [0m] [1müìã [GATEWAY] Policy enforcement header summary[0m [[34m[1m__main__[0m] [36mendpoint[0m=[35m/metrics[0m [36mgeolocation_header_present[0m=[35mTrue[0m [36mpolicy_enforcement_ready[0m=[35mTrue[0m [36msignature_header_present[0m=[35mTrue[0m [36msignature_input_present[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.798969Z[0m [[32m[1minfo     [0m] [1mSecurityManager checking validation conditions for non-nonce request[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.802851Z[0m [[32m[1minfo     [0m] [1mSecurityManager calling validate_request_headers[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T21:34:42.806925Z[0m [[32m[1minfo     [0m] [1mGateway validate_request_headers called[0m [[34m[1m__main__[0m] [36mheaders_present[0m=[35m['Host', 'User-Agent', 'Accept-Encoding', 'Accept', 'Connection', 'Content-Type', 'Workload-Geo-Id', 'Signature-Input', 'Signature', 'Content-Length', 'Traceparent'][0m [36mvalidate_geolocation[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.811633Z[0m [[32m[1minfo     [0m] [1mSignature validation passed (basic format check)[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mpublic_key_hash[0m=[35m8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282[0m
INFO:__main__:[2m2025-08-27T21:34:42.812074Z[0m [[32m[1minfo     [0m] [1mGateway checking geolocation validation[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mworkload_geo_id_str[0m=[35m{"client_workload_id":"agent-geo-policy-violation-002","client_workload_location":{"region":"EU","state":"Germany","city":"Berlin"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T21:34:42.812527Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation called[0m [[34m[1m__main__[0m] [36mpublic_key_hash[0m=[35m8b3567c8f38fb81f3aad3f52cb671398d13916ca8b6ba4068086dca6da9fc282[0m [36mworkload_geo_id[0m=[35m{'client_workload_id': 'agent-geo-policy-violation-002', 'client_workload_location': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'client_workload_location_type': 'geographic-region', 'client_workload_location_quality': 'GNSS', 'client_type': 'thick'}[0m
INFO:__main__:[2m2025-08-27T21:34:42.812899Z[0m [[32m[1minfo     [0m] [1mGateway geolocation comparison[0m [[34m[1m__main__[0m] [36mactual_city[0m=[35mBERLIN[0m [36mactual_country[0m=[35mEU[0m [36mactual_state[0m=[35mGERMANY[0m [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mexpected_city[0m=[35mSANTA CLARA[0m [36mexpected_country[0m=[35mUS[0m [36mexpected_state[0m=[35mCALIFORNIA[0m
WARNING:__main__:[2m2025-08-27T21:34:42.813289Z[0m [[33m[1mwarning  [0m] [1mGateway geolocation validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': False, 'reason': 'Geolocation verification failed', 'details': {'expected': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'received': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'agent_name': 'agent-geo-policy-violation-002'}}[0m
WARNING:__main__:[2m2025-08-27T21:34:42.813659Z[0m [[33m[1mwarning  [0m] [1mSecurityManager validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': False, 'reason': 'Geolocation verification failed', 'details': {'expected': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'received': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'agent_name': 'agent-geo-policy-violation-002'}}[0m
INFO:__main__:[2m2025-08-27T21:34:42.923308Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] Full relevant headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mContent-Type[0m=[35mNone[0m [36mSignature[0m=[35mNone[0m [36mSignature-Input[0m=[35mkeyid="e8d80de5a122ac4cf27a60e1b95966c9600014100c8a64a927a2870b29b79256", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36mWorkload-Geo-ID[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mmethod[0m=[35mGET[0m
INFO:__main__:[2m2025-08-27T21:34:42.923746Z[0m [[32m[1minfo     [0m] [1müîç [GATEWAY] API call headers for policy enforcement debugging[0m [[34m[1m__main__[0m] [36mclient_ip[0m=[35mNone[0m [36mcontent_type[0m=[35mNone[0m [36mendpoint[0m=[35m/nonce[0m [36mexpected_headers_for_endpoint[0m=[35mSignature-Input only (no geolocation)[0m [36mmethod[0m=[35mGET[0m [36mpath[0m=[35m/nonce[0m [36mquery_params[0m=[35m{'public_key_hash': 'e8d80de5a122ac4cf27a60e1b95966c9600014100c8a64a927a2870b29b79256'}[0m [36msignature_input_present[0m=[35mTrue[0m [36msignature_input_value[0m=[35mkeyid="e8d80de5a122ac4cf27a60e1b95966c9600014100c8a64a927a2870b29b79256", created=1756330482, expires=1756330782, alg="Ed25519"[0m [36msignature_present[0m=[35mFalse[0m [36msignature_value[0m=[35mNone[0m [36muser_agent[0m=[35mpython-requests/2.31.0[0m [36mworkload_geo_id_present[0m=[35mFalse[0m [36mworkload_geo_id_value[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T21:34:42.925596Z[0m [[32m[1minfo     [0m] [1müìã [GATEWAY] Policy enforcement header summary[0m [[34m[1m__main__[0m] [36mendpoint[0m=[35m/nonce[0m [36mgeolocation_header_present[0m=[35mFalse[0m [36mpolicy_enforcement_ready[0m=[35mTrue[0m [36msignature_header_present[0m=[35mFalse[0m [36msignature_input_present[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T21:34:42.925949Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
WARNING:__main__:[2m2025-08-27T21:34:42.926250Z[0m [[33m[1mwarning  [0m] [1m‚ùå [GATEWAY] Nonce request from unauthorized agent[0m [[34m[1m__main__[0m] [36magent_public_key_hash[0m=[35me8d80de5a122ac4c...[0m [36mrequest_ip[0m=[35m127.0.0.1[0m
